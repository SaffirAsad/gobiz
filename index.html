<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Append Row to Google Sheet</title>
</head>
<body>
  <h1>Append Row to Google Sheet</h1>
  <form id="input-form">
    <label for="input1">Input 1:</label>
    <input type="text" id="input1" name="input1">
    <br>
    <label for="input2">Input 2:</label>
    <input type="text" id="input2" name="input2">
    <br>
    <label for="input3">Input 3:</label>
    <input type="text" id="input3" name="input3">
    <br>
    <button type="submit">Append Row</button>
  </form>

  <script src="https://apis.google.com/js/api.js"></script>
  <script>
    // Client ID and API key from the Google Developers Console
    const CLIENT_ID = '110414588798816752291';
    const API_KEY = "-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDCKa0aJnoAFBig\nqf8upyQpttu5FDPvyb+y2WXWdG11qWIWzPUzyURXmbq7cHbrOQT01j9QfHxsyZ81\n3w42gMMOFDx8Enl5YtyQCeDzZlFLJDVhBgm4rL6KKe4uko/gJnaBFbwMFVgiPZBF\nOKiM6aKtSkkYyQwBjPOoaKRQLrwgSQNKEG788DQ3NSwHhLjiV4RO/yEjIAQvZK0E\nW0OyKl2sxoJOHEkjcOwb/G9PK36kTphbq5Zgu2bXysspaGJ7jbfmIZKXIBx2cI7W\nvZIqxTkXOBH8eeVMdPZ5F1lqReVpezmzxpWSTS/9JA7D+qvAmlUE5E+7L0NCOrqE\nHmrSKxwHAgMBAAECggEAV9Q9YvZjupRcnZS4g5SE1b/LPbnnUoFLD26q0+sftplT\n7ydwhaf2G8BFCVPy3y2QUeZ2hoSBTj6YH+jSB5KQaVZ7E87RlzjCt/9X/BJdFKYA\n5W4zSJAPsvULspKGtakAcxzvTvH6x6ZclAtwpylqdoQDc8xB+5OUhqorJcA2Rk2m\nPNixrD4FXsKc3roOdM0mGsEMtlvwngpyWaEGB6c98BYyibwucyMSZAOx7H/3Wd3R\nU6dteApDy3om4W0ihop4JDjondmF3vrPVrc5Je3ipc79mIEkcGD6OBzcnxSJoVVa\nM8tE9jP+trXLzUYpMponBBTKHnoa6zb9vbUis2cu2QKBgQD0S2fG9rWq9T4ACl3d\nqwLZ24nMTsyjiwYK4a62xc3OQQaQCNlLsK7N9fTO57+zR2/QSznEBB59dhCYMGTA\nU1PmSjA07wwgyb+/Rx6XYxv4WfqPhkI9iXqqkZ1Jz/rZUyKHqGgbANAvfW1WRGTJ\nIR7uFvasOojsgUHQAe3Q+GyR+QKBgQDLd1a5R0KOtV+FRF9nSrHUUgnAjVrD6QHj\n7pl4ILYPkA0+rmZYkgA5H+2b1Y2jQL5NXDEiEQnW9d0Di+tHG8lhXE7ueDTnT/VI\nQMv5tBjwFmQD/PY0OFrSZj5Pjon+MsqidwWu7vdyrah+ao8FNsm9vSLB6OKru1Rz\njxIRLICd/wKBgDEUwUnhIUiysv0xGADELfN1Py80Gbs14EXpZ7/C6AFrYRUpIfcq\nDUTGCKRVPVeYn6dapcVzCmksglMBTgyx8SZQe3T3HhmsTwDwGf5SZDk2YrfZQo+4\nglOoo9BDn+Nv530X4aqjNDCGY6Q0Y4dhRySQqoiZzg6uPXm8GXqlnrKJAoGAJxSp\nB7V0R0z3J/XWDVT/izSmwuFjybV7s3gk6jn+PkcBBEUjS2ffuxky3nfKWM0awGkw\n1sZHCY74ALJjYqknqRe94XgdUUC+cD5h73h0QclLNKjl8WnRqBATb9yFDNpcqZAK\n+2rTBKfucTmuduXrIhKuFmjRAQNeWUPlyH6vxakCgYEAkTuXAjpSNSv5nyw2Tp9g\nqPIlrkPwvLQVyGfOqwfHZwSI/nCqgvxXlO7XbafZAZ+pbiAB5xM6ABYv8laQbAP7\nILAJjWCMLS/ulIvx9l+eEJ2PG7ayt0Npc9gtivKTBKpaz8QHVHbHIhGOjXWPFsus\nn/WiO/Fy1wW7aPcXdmAsFIU=\n-----END PRIVATE KEY-----\n";

    // ID and name of the Google Sheet to append rows to
    const SHEET_ID = '1ywCRiYUUUTRF1RiwQ7XMt2-4IiQpceQTlKzOO1l_3kc';
    const SHEET_NAME = 'Orders';
    // Array to store input data
    let inputData = [];

    function start() {
      gapi.client.init({
        apiKey: API_KEY,
        clientId: CLIENT_ID,
        discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
        scope: "https://www.googleapis.com/auth/spreadsheets"
      }).then(() => {
        console.log('Google Sheets API client initialized!');
      });
    }
    // Load the Google Sheets API
    gapi.load('client', start);
    // Handle form submission
    const form = document.getElementById('input-form');
    form.addEventListener('submit', (event) => {
      event.preventDefault();
      inputData = [
        document.getElementById('input1').value,
        document.getElementById('input2').value,
        document.getElementById('input3').value
      ];
      appendRow(inputData);
    });

    // Append a new row to the Google Sheet
    function appendRow(data) {
      const sheets = gapi.client.sheets.spreadsheets.values;
      const range = `${SHEET_NAME}!A:A`;
      const request = sheets.append({
        spreadsheetId: SHEET_ID,
        range: range,
        valueInputOption: 'RAW',
        insertDataOption: 'INSERT_ROWS',
        resource: { values: [data] },
      });
      request.then((response) => {
        console.log(`${response.result.updates.updatedCells} cells appended.`);
      }, (reason) => {
        console.error(`Failed to append row: ${reason.result.error.message}`);
      });
    }
  </script>
</body>
</html>

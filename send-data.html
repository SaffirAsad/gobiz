<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Append Row to Google Sheet</title>
</head>
<body>
  <h1>Append Row to Google Sheet</h1>
  <form id="input-form">
    <label for="input1">Input 1:</label>
    <input type="text" id="input1" name="input1">
    <br>
    <label for="input2">Input 2:</label>
    <input type="text" id="input2" name="input2">
    <br>
    <label for="input3">Input 3:</label>
    <input type="text" id="input3" name="input3">
    <br>
    <button type="submit">Append Row</button>
  </form>

  <script src="https://apis.google.com/js/api.js"></script>
  <script>
    // Client ID and API key from the Google Developers Console
    const CLIENT_ID = '110414588798816752291';
    const API_KEY = '091c70bf31e06aca8f6c53e14146ff8c6eae1d5d';

    // ID and name of the Google Sheet to append rows to
    const SHEET_ID = '1ywCRiYUUUTRF1RiwQ7XMt2-4IiQpceQTlKzOO1l_3kc';
    const SHEET_NAME = 'Orders';
    // Array to store input data
    let inputData = [];

    function start() {
      gapi.client.init({
        apiKey: API_KEY,
        clientId: CLIENT_ID,
        discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
        scope: "https://www.googleapis.com/auth/spreadsheets"
      }).then(() => {
        console.log('Google Sheets API client initialized!');
      });
    }
    // Load the Google Sheets API
    gapi.load('client', start);
    // Handle form submission
    const form = document.getElementById('input-form');
    form.addEventListener('submit', (event) => {
      event.preventDefault();
      inputData = [
        document.getElementById('input1').value,
        document.getElementById('input2').value,
        document.getElementById('input3').value
      ];
      appendRow(inputData);
    });

    // Append a new row to the Google Sheet
    function appendRow(data) {
      const sheets = gapi.client.sheets.spreadsheets.values;
      const range = `${SHEET_NAME}!A:A`;
      const request = sheets.append({
        spreadsheetId: SHEET_ID,
        range: range,
        valueInputOption: 'RAW',
        insertDataOption: 'INSERT_ROWS',
        resource: { values: [data] },
      });
      request.then((response) => {
        console.log(`${response.result.updates.updatedCells} cells appended.`);
      }, (reason) => {
        console.error(`Failed to append row: ${reason.result.error.message}`);
      });
    }
  </script>
</body>
</html>
